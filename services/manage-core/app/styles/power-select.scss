// Note, this must be included _after_ Bootstrap.

// @todo Since custom select prefrills input vars that are calculated, switch to straigh input vars.

// The standard trigger
$ember-power-select-trigger-border: $custom-select-border-width solid $custom-select-border-color;
$ember-power-select-trigger-default-border-radius: $custom-select-border-radius;

$ember-power-select-background-color: $custom-select-bg;
$ember-power-select-line-height: $custom-select-line-height;
$ember-power-select-text-color: $custom-select-color;

// Disabled trigger
$ember-power-select-disabled-background-color: $custom-select-disabled-bg;

// Active/focused trigger
$ember-power-select-focus-outline: none;
$ember-power-select-active-trigger-border: $custom-select-border-width solid $custom-select-focus-border-color !default;
$ember-power-select-default-focus-border: $custom-select-border-width solid $custom-select-focus-border-color !default;
$ember-power-select-focus-box-shadow: $custom-select-box-shadow, $custom-select-focus-box-shadow;

// Placeholder. Custom select does not have this, so use the regular input.
$ember-power-select-placeholder-color: $input-placeholder-color;

// Maintain trigger border radius when open
$ember-power-select-opened-border-radius: $custom-select-border-radius;

// Dropdown
$ember-power-select-dropdown-border: $dropdown-border-width solid $dropdown-border-color !default;
$ember-power-select-dropdown-default-border-radius: $dropdown-border-radius;
$ember-power-select-dropdown-box-shadow: $dropdown-box-shadow;
$ember-power-select-dropdown-margin: $dropdown-spacer; // Margin between the dropdown and the trigger
$ember-power-select-dropdown-contiguous-border: $ember-power-select-dropdown-border;
$ember-basic-dropdown-content-background-color: $dropdown-bg;

// Dropdown options
$ember-power-select-selected-background: $dropdown-link-active-bg;
$ember-power-select-highlighted-background: $dropdown-link-hover-bg;
$ember-power-select-highlighted-color: $dropdown-link-hover-color;
$ember-power-select-disabled-option-color: $dropdown-link-disabled-color;

// Search input
$ember-power-select-search-field-border: $input-border-width solid $input-border-color;
$ember-power-select-search-input-border-radius: $input-border-radius;
$ember-power-select-search-field-focus-border: $input-border-width solid $input-focus-border-color;
$ember-power-select-focus-box-shadow: $input-box-shadow, $input-focus-box-shadow;

// Multiple options
$ember-power-select-multiple-option-line-height: $custom-select-line-height;
$ember-power-select-multiple-option-border-radius: $input-border-radius-sm;
$ember-power-select-multiple-selection-background-color: $ember-power-select-selected-background;
$ember-power-select-multiple-selection-color: $dropdown-link-active-color;

// Divide by two to match the option margins
// The left padding is cut in half so the close button is centered
$power-select-half-padding-y: $custom-select-padding-y / 2;
$power-select-half-padding-x: $custom-select-padding-x / 2;
$ember-power-select-multiple-option-padding: $power-select-half-padding-y $custom-select-padding-x $power-select-half-padding-y $power-select-half-padding-x;

@import "ember-power-select";

.ember-power-select-multiple-option {
  margin: 0;
  border: none;
  // use same value as padding for trigger element but cut in half
  margin-right: $power-select-half-padding-x;
  margin-bottom: $power-select-half-padding-y;
}

.ember-power-select-multiple-options {
  padding: 0;
  // This allows the options to utilize more space within the control
  margin: ($power-select-half-padding-y * -1) (($power-select-half-padding-x) * -1);
}

.ember-power-select-trigger-multiple-input {
  // Ensure the input box is aligned with the selection pills.
  margin-left: $power-select-half-padding-x;
  margin-top: $power-select-half-padding-y;
  margin-bottom: $power-select-half-padding-y;
}

// Additional trigger items not set
.ember-power-select-trigger {
  // Hard set in the custom-select component
  display: inline-block;
  width: 100%;
  vertical-align: middle;

  // Apply variables that power select does not address with their own vars.
  min-height: $custom-select-height; // Using min-height instead of height so multi-select can wrap

  // The bottom padding is zero to account for the fact the multiple options have margin-bottom applied of the same value.
  // The min-height will ensure the control is still the correct height even when nothing is selected.
  padding: $custom-select-padding-y ($custom-select-padding-x + $custom-select-indicator-padding) 0 $custom-select-padding-x;
  font-weight: $custom-select-font-weight;
  box-shadow: $custom-select-box-shadow;

  // Apply input variables to match a "regular" input (these are not defined for bootstrap custom select)
  font-size: $input-font-size;
  transition: $custom-forms-transition;

  // Apply the custom select background/indicator and reapply color
  background: $custom-select-background;
  background-color: $ember-power-select-background-color;

  &[aria-disabled=true] {
    color: $custom-select-disabled-color;
    opacity: 1;
  }
}

// Remove text left-margin because the indicator icon will be removed
.ember-power-select-selected-item, .ember-power-select-placeholder {
  margin-left: 0;
}

// Remove the indicator icon as we're using from BS
.ember-power-select-status-icon {
  display: none;
}

// Make select dropdown look like bootstrap downdown
.ember-power-select-dropdown {
  padding: $dropdown-padding-y 0;
  font-size: $font-size-base;
  background-clip: padding-box;
  z-index: $zindex-dropdown;
  min-width: $dropdown-min-width;

  // The dropdown inherits the select border radius by default.
  // This is because, originally, the dropdown menu was "connected" to the select.
  // Reset to use the dropdown border radius.
  &.ember-basic-dropdown-content--above {
    border-bottom-left-radius: $ember-power-select-dropdown-default-border-radius;
    border-bottom-right-radius: $ember-power-select-dropdown-default-border-radius;
  }
  &.ember-basic-dropdown-content--below,
  &.ember-basic-dropdown-content--in-place {
    border-top-left-radius: $ember-power-select-dropdown-default-border-radius;
    border-top-right-radius: $ember-power-select-dropdown-default-border-radius;
  }
}

// Make options look like dropdown-items.
.ember-power-select-option {
  display: block;
  white-space: nowrap;
  padding: $dropdown-item-padding-y $dropdown-item-padding-x;
  color: $dropdown-link-color;

  &:active {
    color: $dropdown-link-active-color;
    @include gradient-bg($dropdown-link-active-bg);
  }
}

.ember-power-select-option {
  &[aria-diabled="true"] {
    text-decoration: none;
    pointer-events: none;
    background-color: transparent;
    // Remove CSS gradients
    background-image: none;
  }
  &[aria-selected="true"] {
    color: $dropdown-link-active-color; // PS doesn't have this var, use BS directly
    @include gradient-bg($ember-power-select-selected-background);
  }
  &[aria-current="true"]:not([aria-selected="true"]) {
    // Reset the current color so we can use the :hover state.
    // But don't do it on selected items.
    color: $dropdown-link-color;
    background-color: $ember-basic-dropdown-content-background-color;

    // Include the :active style so the click will change the background
    &:active {
      color: $dropdown-link-active-color; // PS doesn't have this var, use the BS one directly
      @include gradient-bg($ember-power-select-selected-background);
    }

    // Include the :hover style (we didn't use the current label because it doesn't "off" the color when the control is exited)
    &:hover {
      color: $ember-power-select-highlighted-color;
      @include gradient-bg($ember-power-select-highlighted-background);
    }
  }
}

.ember-power-select-option--no-matches-message {
  pointer-events: none;
  // Mimic dropdown-item-text
  display: block;
  padding: $dropdown-item-padding-y $dropdown-item-padding-x;
  color: $dropdown-link-color;
}

.ember-power-select-search-input {
  // Hard set in the form-control component
  display: block;
  width: 100%;
  background-clip: padding-box;

  // Apply variables that power select does not address on their own.
  height: $input-height;
  padding: $input-padding-y $input-padding-x;
  font-size: $input-font-size;
  font-weight: $input-font-weight;
  line-height: $input-line-height;
  color: $input-color;
  background-color: $input-bg;

  @include box-shadow($input-box-shadow);
  @include transition($input-transition);

  &:focus {
    color: $input-focus-color;
  }

  &::placeholder {
    color: $input-placeholder-color;
    opacity: 1;
  }
}

// Search field
.ember-power-select-search {
  padding: $dropdown-item-padding-y $dropdown-item-padding-x; // override padding to match dropdown item
}
